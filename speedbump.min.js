!function(e){e.fn.speedbump=function(t){var c=e.extend({speedbump_exclusions:"",speedbump_selector:".speedbump",speedbump_close_selectors:"speedbump-close-button, .button.close"},t);return e.expr[":"].external=function(e){var t=e.hostname.split(".").reverse();if(!(t.length>1))return!1;var s=t[1]+"."+t[0],n=window.location.hostname.split(".").reverse(),r=""==n[0]?"":n[1]+"."+n[0],l=c.speedbump_exclusions.split(",");for(i=0;i<l.length;i++)if(checkme=l[i],""!=checkme&&-1!==checkme.indexOf("*")){if(-1===checkme.indexOf(".*")&&(checkme=checkme.replace("*",".*")),match=e.href.match(new RegExp(checkme)),null!==match&&0===match.index)return!1}else if(e.href===checkme)return!1;return!e.href.match(/^mailto\:/)&&!e.href.match(/^tel\:/)&&!e.href.match(/^javascript\:/)&&s!==r},e("a:external:not(.no_warning)").addClass("ext_link"),e(c.speedbump_close_selectors).click(function(){e(c.speedbump_selector).removeClass("is-active")}),e("a.ext_link").click(function(t){e(c.speedbump_selector).addClass("is-active"),t.preventDefault();var s=e(this).attr("href");e(c.speedbump_selector+" a.button").unbind("click"),e(c.speedbump_selector+" a.button").click(function(){e(c.speedbump_selector).removeClass("is-active"),e("html, body").removeAttr("style"),0==e(this).hasClass("close")&&window.open(s)})}),!0}}(jQuery);
